///////////////////////////////////////////////////////////////////////////
// Srevolution 2010 / 2011
// Programmed by: Team Srevolution
// Website: www.xcoding.net
// File info: Public packet data
///////////////////////////////////////////////////////////////////////////
using System;
using Framework;
using System.Linq;
using System.Text;
using System.Threading;
using System.Data.SqlClient;
using System.Collections.Generic;
using System.Diagnostics;

namespace SrxRevo
{
    public partial class Systems
    {
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // Pvp Base
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public void Pvpsystem()
        {
            try
            {
                byte pvptype = Character.Information.Pvptype;
                if (Character.Information.Pvpstate == pvptype) return;

                if (pvptype > 0)
                {
                    MsSQL.UpdateData("UPDATE character SET Pvpstate='" + pvptype + "' WHERE name='" + Character.Information.Name + "'");
                    Character.Information.PvpWait = false;
                    Character.Information.PvP = true;
                    Send(Packet.PvpSystemData(Character.Information.UniqueID, pvptype));
                    StopPvpTimer();
                }
                else
                {
                    MsSQL.UpdateData("UPDATE character SET Pvpstate='" + pvptype + "' WHERE name='" + Character.Information.Name + "'");
                    Character.Information.PvpWait = false;
                    Character.Information.PvP = false;
                    Send(Packet.PvpSystemData(Character.Information.UniqueID, 0));
                    StopPvpTimer();
                }
            }
            catch (Exception ex)
            {
                Systems.Debugger.Write(ex);
            }
        }
    }
}